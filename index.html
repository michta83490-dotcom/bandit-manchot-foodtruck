<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ğŸ° La BoÃ®te Ã  Nems â€“ Jeu</title>

<style>
  body{
    font-family: Arial, sans-serif;
    background:#111;
    color:#fff;
    text-align:center;
    padding:20px;
  }
  .machine{
    max-width:440px;
    margin:0 auto;
    padding:20px;
    background:rgba(255,255,255,0.08);
    border-radius:16px;
    border:1px solid rgba(255,255,255,0.12);
  }
  .reels{
    font-size:64px;
    letter-spacing:18px;
    margin:18px 0 10px;
    user-select:none;
  }
  button{
    font-size:20px;
    padding:12px 30px;
    border:none;
    border-radius:10px;
    cursor:pointer;
  }
  button:disabled{ opacity:0.6; cursor:not-allowed; }
  .spin{ background:#ffd700; }
  .site{ margin-top:14px; background:#fff; }
  .msg{ margin-top:14px; font-size:18px; min-height:52px; }
  .small{
    font-size:12px;
    opacity:0.85;
    margin-top:10px;
    line-height:1.4;
  }
</style>
</head>

<body>
<h1>ğŸ° LA BOÃTE Ã€ NEMS</h1>
<p>Un petit jeu pour le plaisirâ€¦ et parfois une surprise ğŸ˜‹</p>

<div class="machine">
  <div id="reels" class="reels">ğŸ’ â­ 7ï¸âƒ£</div>

  <button id="spinBtn" class="spin" onclick="spin()">SPIN</button>

  <div id="msg" class="msg"></div>

  <button class="site" onclick="goSite()">DÃ©couvrir La BoÃ®te Ã  Nems</button>

  <div class="small">
    1 partie par jour<br>
    Cadeau remis uniquement lors dâ€™une commande (selon disponibilitÃ©)
  </div>
</div>

<script>
/* =========================
   RÃ‰GLAGES (TU PEUX CHANGER)
   ========================= */
const SITE_URL = "https://la-boite-a-nems-le-muy.eatbu.com";

// Chances de gain (approx) :
const CHANCE_SOFT = 5;   // 1 fois sur 5  -> ğŸ’ğŸ’ğŸ’
const CHANCE_BOX  = 8;   // 1 fois sur 8  -> â­â­â­
const CHANCE_PAD  = 20;  // 1 fois sur 20 -> 7ï¸âƒ£7ï¸âƒ£7ï¸âƒ£

// 1 partie par jour (par appareil)
const PLAY_KEY = "boite_a_nems_played_" + new Date().toISOString().slice(0,10);

/* =========================
   MACHINE
   ========================= */
const reelsEl = document.getElementById("reels");
const msgEl   = document.getElementById("msg");
const btnEl   = document.getElementById("spinBtn");

// Symboles pour lâ€™animation (visuel)
const animSymbols = ["ğŸ’","â­","7ï¸âƒ£","ğŸ‹","ğŸ€","ğŸ””"];

function alreadyPlayedToday(){
  return localStorage.getItem(PLAY_KEY) === "yes";
}

function setPlayedToday(){
  localStorage.setItem(PLAY_KEY, "yes");
}

function goSite(){
  window.open(SITE_URL, "_blank");
}

// Petite animation â€œÃ§a tourneâ€
function animateOnce(){
  const a = animSymbols[Math.floor(Math.random()*animSymbols.length)];
  const b = animSymbols[Math.floor(Math.random()*animSymbols.length)];
  const c = animSymbols[Math.floor(Math.random()*animSymbols.length)];
  reelsEl.textContent = ${a} ${b} ${c};
}

// Tirage avec probabilitÃ©s DIFFERENTES
function pickOutcome(){
  // ProbabilitÃ© globale = P(PAD) + P(BOX) + P(SOFT), le reste = perdu
  const pPad  = 1 / CHANCE_PAD;   // 0.05
  const pBox  = 1 / CHANCE_BOX;   // 0.125
  const pSoft = 1 / CHANCE_SOFT;  // 0.2

  const r = Math.random();

  if(r < pPad) return "PAD";                     // 7ï¸âƒ£7ï¸âƒ£7ï¸âƒ£
  if(r < pPad + pBox) return "BOX";              // â­â­â­
  if(r < pPad + pBox + pSoft) return "SOFT";     // ğŸ’ğŸ’ğŸ’
  return "LOSE";
}

function loseRollNoJackpot(){
  // Choisit au hasard mais interdit les 3 jackpots
  while(true){
    const a = animSymbols[Math.floor(Math.random()*animSymbols.length)];
    const b = animSymbols[Math.floor(Math.random()*animSymbols.length)];
    const c = animSymbols[Math.floor(Math.random()*animSymbols.length)];
    const s = ${a}${b}${c};
    if(s === "ğŸ’ğŸ’ğŸ’") continue;
    if(s === "â­â­â­") continue;
    if(s === "7ï¸âƒ£7ï¸âƒ£7ï¸âƒ£") continue;
    return [a,b,c];
  }
}

function lockUI(locked){
  btnEl.disabled = locked;
}

function spin(){
  if(alreadyPlayedToday()){
    msgEl.innerHTML = "âŒ Tu as dÃ©jÃ  jouÃ© aujourdâ€™hui. Reviens demain ğŸ™‚";
    return;
  }

  lockUI(true);
  msgEl.textContent = "";

  // Animation 1 seconde
  const start = Date.now();
  const timer = setInterval(animateOnce, 90);

  setTimeout(() => {
    clearInterval(timer);

    const outcome = pickOutcome();

    if(outcome === "PAD"){
      reelsEl.textContent = "7ï¸âƒ£ 7ï¸âƒ£ 7ï¸âƒ£";
      msgEl.innerHTML = "ğŸ‰ JACKPOT !<br><b>1 Pad thaÃ¯ traditionnel nature</b><br><small>Ã€ rÃ©cupÃ©rer au camion (selon disponibilitÃ©)</small>";
    } else if(outcome === "BOX"){
      reelsEl.textContent = "â­ â­ â­";
      msgEl.innerHTML = "ğŸ BRAVO !<br><b>1 box apÃ©ro 8 piÃ¨ces</b><br><small>Ã€ rÃ©cupÃ©rer au camion (selon disponibilitÃ©)</small>";
    } else if(outcome === "SOFT"){
      reelsEl.textContent = "ğŸ’ ğŸ’ ğŸ’";
      msgEl.innerHTML = "ğŸ¥¤ GAGNÃ‰ !<br><b>1 boisson soft</b><br><small>Ã€ rÃ©cupÃ©rer au camion (selon disponibilitÃ©)</small>";
    } else {
      const [a,b,c] = loseRollNoJackpot();
      reelsEl.textContent = ${a} ${b} ${c};
      msgEl.innerHTML = "ğŸ˜¢ Perduâ€¦ retente ta chance demain !";
    }

    setPlayedToday();
    lockUI(false);

  }, 1100);
}

// Si dÃ©jÃ  jouÃ© -> message direct
if(alreadyPlayedToday()){
  msgEl.innerHTML = "âŒ Tu as dÃ©jÃ  jouÃ© aujourdâ€™hui. Reviens demain ğŸ™‚";
}
</script>

</body>
</html>
