<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>La Bo√Æte √† Nems - Bandit Manchot</title>
  <style>
    body{
      font-family: Arial, sans-serif;
      text-align:center;
      background:#111;
      color:#fff;
      margin:0;
      padding:24px 12px;
    }
    h1{ margin:10px 0 6px; letter-spacing:1px; }
    .sub{ opacity:.9; margin:0 0 18px; }

    .card{
      max-width:720px;
      margin:0 auto;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      border-radius:16px;
      padding:18px 14px;
      box-shadow:0 10px 30px rgba(0,0,0,.35);
    }

    .reels{
      display:flex;
      justify-content:center;
      gap:14px;
      margin:12px 0 14px;
    }

    .reel{
      width:92px;
      height:92px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:rgba(0,0,0,.35);
      border:1px solid rgba(255,255,255,.18);
      border-radius:14px;
      user-select:none;
    }

    .sym{
      width:72px; height:72px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:46px;
      border-radius:12px;
      font-weight:900;
    }

    .cherry{ background:rgba(255,0,0,.12); }
    .cherry::before{ content:"\1F352"; } /* üçí */

    .star{ background:rgba(255,215,0,.12); }
    .star::before{ content:"\2B50"; } /* ‚≠ê */

    .seven{
      background:rgba(0,140,255,.18);
      color:#dff2ff;
      font-size:44px;
      box-shadow: inset 0 0 0 2px rgba(255,255,255,.12);
    }
    .seven::before{ content:"7"; }

    .lemon{ background:rgba(255,255,0,.10); }
    .lemon::before{ content:"\1F34B"; } /* üçã */

    .bell{ background:rgba(255,255,255,.08); }
    .bell::before{ content:"\1F514"; } /* üîî */

    .clover{ background:rgba(0,255,0,.10); }
    .clover::before{ content:"\1F340"; } /* üçÄ */

    .btn{
      border:0;
      padding:12px 18px;
      border-radius:12px;
      font-size:18px;
      cursor:pointer;
    }
    .spin{
      background:#f4c542;
      color:#111;
      font-weight:900;
      min-width:140px;
    }
    .spin:disabled{ opacity:.55; cursor:not-allowed; }

    .msg{
      margin-top:14px;
      font-size:18px;
      min-height:28px;
      font-weight:800;
    }
    .ok{ color:#64f58d; }
    .no{ color:#ff6b6b; }

    .rowBtns{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      justify-content:center;
      margin-top:14px;
    }
    .linkBtn{
      background:#e9e9e9;
      color:#111;
      font-weight:800;
    }
    .greenBtn{
      background:#29c24a;
      color:#0b1a0f;
      font-weight:900;
    }

    .small{
      margin-top:12px;
      font-size:14px;
      opacity:.92;
      text-align:left;
      max-width:620px;
      margin-left:auto;
      margin-right:auto;
      line-height:1.35;
    }
    .legendTitle{ font-weight:900; margin-top:6px; }
    .hr{ height:1px; background:rgba(255,255,255,.15); margin:10px 0; }

    .codeBox{
      margin-top:10px;
      display:none;
      padding:10px 12px;
      border-radius:12px;
      background:rgba(0,0,0,.35);
      border:1px dashed rgba(255,255,255,.25);
      max-width:440px;
      margin-left:auto;
      margin-right:auto;
    }
    .codeBox b{ font-size:18px; letter-spacing:1px; }
  </style>
</head>

<body>
  <h1>LA BOITE A NEMS</h1>
  <div class="sub">Joue pour le fun... et parfois un cadeau</div>

  <div class="card">
    <div class="reels">
      <div class="reel"><div class="sym cherry" id="s1"></div></div>
      <div class="reel"><div class="sym star"   id="s2"></div></div>
      <div class="reel"><div class="sym seven"  id="s3"></div></div>
    </div>

    <button class="btn spin" id="spinBtn" onclick="spin()">SPIN</button>

    <div class="msg" id="msg"></div>

    <div class="codeBox" id="codeBox">
      Code de reclamation (valable 10 min) :<br>
      <b id="claimCode"></b>
      <div style="margin-top:6px;font-size:13px;opacity:.9">
        A montrer au camion (ou a donner au telephone).
      </div>
    </div>

    <div class="rowBtns">
      <button class="btn linkBtn" onclick="goSite()">Decouvrir La Boite a Nems</button>
      <button class="btn greenBtn" onclick="callPhone()">Commander (telephone)</button>
      <button class="btn greenBtn" onclick="goWhatsApp()">Commander (WhatsApp)</button>
    </div>

    <div class="small">
      <div class="legendTitle">Legende des gains</div>
      üçíüçíüçí = 1 boisson soft<br>
      ‚≠ê‚≠ê‚≠ê = 1 box apero 8 pieces<br>
      777 = 1 Pad thai traditionnel nature
      <div class="hr"></div>
      Commande minimum : 30 EUR.<br>
      Cadeau remis uniquement lors d une commande (selon disponibilite).<br>
      Gain valable 48h a compter du gain.<br>
      Si tu gagnes : tu ne peux plus rejouer pendant 24h sur ce telephone.<br>
      Un code de reclamation est genere (valable 10 min) pour limiter les profiteurs.
    </div>
  </div>

<script>
  // ===== REGLAGES =====
  var URL_SITE = "https://la-boite-a-nems-le-muy.eatbu.com";
  var TEL = "+33782549660";
  var WHATSAPP = "https://wa.me/33782549660";

  // Frequences de gains
  // Soft : 1/5, Box : 1/8, Pad : 1/20 (rare)
  var P_SOFT = 1/5;
  var P_BOX  = 1/8;
  var P_PAD  = 1/20;

  // Blocage 24h si gain
  var COOLDOWN_H = 24;

  // Gain valable 48h
  var GAIN_VALID_H = 48;

  // Code reclamation 10 min
  var CLAIM_VALID_MIN = 10;

  var spinBtn = document.getElementById("spinBtn");
  var msg = document.getElementById("msg");
  var codeBox = document.getElementById("codeBox");
  var claimCodeEl = document.getElementById("claimCode");

  var s1 = document.getElementById("s1");
  var s2 = document.getElementById("s2");
  var s3 = document.getElementById("s3");

  function setMsg(text, cls){
    msg.className = "msg " + (cls || "");
    msg.textContent = text;
  }

  function goSite(){ window.open(URL_SITE, "_blank"); }
  function callPhone(){ window.location.href = "tel:" + TEL; }
  function goWhatsApp(){ window.open(WHATSAPP, "_blank"); }

  function nowMs(){ return new Date().getTime(); }

  function getJSON(key){
    try { return JSON.parse(localStorage.getItem(key) || "null"); }
    catch(e){ return null; }
  }
  function setJSON(key, val){
    localStorage.setItem(key, JSON.stringify(val));
  }

  function hideClaim(){ codeBox.style.display = "none"; }
  function showClaim(code){
    claimCodeEl.textContent = code;
    codeBox.style.display = "block";
  }

  function isBlockedAfterWin(){
    var w = getJSON("lb_win");
    if(!w) return false;
    var diffH = (nowMs() - w.when) / (1000*60*60);
    return diffH < COOLDOWN_H;
  }

  function generateClaimCode(){
    var d = new Date();
    var y = String(d.getFullYear()).slice(2);
    var m = String(d.getMonth()+1).padStart(2,"0");
    var day = String(d.getDate()).padStart(2,"0");
    var rnd = Math.floor(1000 + Math.random()*9000);
    return "NEMS-" + day + m + y + "-" + rnd;
  }

  function setSym(el, type){
    el.className = "sym " + type;
  }

  function pickAnimType(){
    var a = ["cherry","star","seven","lemon","bell","clover"];
    return a[Math.floor(Math.random()*a.length)];
  }

  function animateReels(durationMs, tickMs, done){
    var start = nowMs();
    var t = setInterval(function(){
      setSym(s1, pickAnimType());
      setSym(s2, pickAnimType());
      setSym(s3, pickAnimType());
      if(nowMs() - start >= durationMs){
        clearInterval(t);
        done();
      }
    }, tickMs);
  }

  function decideOutcome(){
    var u = Math.random();
    if(u < P_PAD) return "PAD";
    if(u < P_PAD + P_BOX) return "BOX";
    if(u < P_PAD + P_BOX + P_SOFT) return "SOFT";
    return "LOSE";
  }

  function forceLoseVisual(){
    var a,b,c;
    do{
      a = pickAnimType(); b = pickAnimType(); c = pickAnimType();
    }while(a===b && b===c);
    setSym(s1, a); setSym(s2, b); setSym(s3, c);
  }

  function spin(){
    hideClaim();

    if(isBlockedAfterWin()){
      setMsg("Tu as deja gagne recemment. Reessaie dans 24h.", "no");
      return;
    }

    spinBtn.disabled = true;
    setMsg("Ca tourne...", "");

    animateReels(1000, 80, function(){
      var outcome = decideOutcome();

      if(outcome === "SOFT"){
        setSym(s1,"cherry"); setSym(s2,"cherry"); setSym(s3,"cherry");
        var code = generateClaimCode();
        setJSON("lb_win", { when: nowMs(), type:"SOFT", validUntil: nowMs() + GAIN_VALID_H*60*60*1000 });
        setJSON("lb_claim", { code: code, exp: nowMs() + CLAIM_VALID_MIN*60*1000 });
        setMsg("Gagne ! 1 boisson soft.", "ok");
        showClaim(code);
      }
      else if(outcome === "BOX"){
        setSym(s1,"star"); setSym(s2,"star"); setSym(s3,"star");
        var code2 = generateClaimCode();
        setJSON("lb_win", { when: nowMs(), type:"BOX", validUntil: nowMs() + GAIN_VALID_H*60*60*1000 });
        setJSON("lb_claim", { code: code2, exp: nowMs() + CLAIM_VALID_MIN*60*1000 });
        setMsg("Gagne ! 1 box apero 8 pieces.", "ok");
        showClaim(code2);
      }
      else if(outcome === "PAD"){
        setSym(s1,"seven"); setSym(s2,"seven"); setSym(s3,"seven");
        var code3 = generateClaimCode();
        setJSON("lb_win", { when: nowMs(), type:"PAD", validUntil: nowMs() + GAIN_VALID_H*60*60*1000 });
        setJSON("lb_claim", { code: code3, exp: nowMs() + CLAIM_VALID_MIN*60*1000 });
        setMsg("JACKPOT ! 1 Pad thai traditionnel nature.", "ok");
        showClaim(code3);
      }
      else{
        forceLoseVisual();
        setMsg("Pas gagne cette fois... retente quand tu veux !", "no");
      }

      spinBtn.disabled = false;
    });
  }

  (function init(){
    if(isBlockedAfterWin()){
      setMsg("Tu as deja gagne recemment. Reessaie dans 24h.", "no");
    } else {
      setMsg("", "");
    }
  })();
</script>

</body>
</html>
